<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Helvetica Neue', Arial, sans-serif;
      font-size: 11pt;
      line-height: 1.6;
      color: #333;
      padding: 40px;
    }

    .header {
      border-bottom: 3px solid #4F46E5;
      padding-bottom: 20px;
      margin-bottom: 30px;
    }

    .header h1 {
      color: #4F46E5;
      font-size: 28pt;
      margin-bottom: 10px;
    }

    .header .period {
      color: #666;
      font-size: 12pt;
    }

    .health-score {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      border-radius: 10px;
      margin-bottom: 30px;
      text-align: center;
    }

    .health-score .score {
      font-size: 48pt;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .health-score .label {
      font-size: 14pt;
      opacity: 0.9;
    }

    .section {
      margin-bottom: 30px;
      page-break-inside: avoid;
    }

    .section-title {
      font-size: 18pt;
      color: #4F46E5;
      border-bottom: 2px solid #E5E7EB;
      padding-bottom: 10px;
      margin-bottom: 20px;
    }

    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin-bottom: 20px;
    }

    .metric-card {
      background: #F9FAFB;
      border: 1px solid #E5E7EB;
      border-radius: 8px;
      padding: 20px;
    }

    .metric-card .metric-value {
      font-size: 24pt;
      font-weight: bold;
      color: #4F46E5;
      margin-bottom: 5px;
    }

    .metric-card .metric-label {
      font-size: 10pt;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .metric-card .metric-change {
      font-size: 9pt;
      margin-top: 5px;
    }

    .metric-change.positive {
      color: #10B981;
    }

    .metric-change.negative {
      color: #EF4444;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    th, td {
      text-align: left;
      padding: 12px;
      border-bottom: 1px solid #E5E7EB;
    }

    th {
      background: #F9FAFB;
      font-weight: 600;
      color: #4F46E5;
    }

    .recommendations {
      background: #FEF3C7;
      border-left: 4px solid #F59E0B;
      padding: 20px;
      border-radius: 5px;
    }

    .recommendations h3 {
      color: #92400E;
      margin-bottom: 15px;
    }

    .recommendations ul {
      list-style-position: inside;
      color: #78350F;
    }

    .recommendations li {
      margin-bottom: 8px;
    }

    .footer {
      margin-top: 50px;
      padding-top: 20px;
      border-top: 2px solid #E5E7EB;
      font-size: 9pt;
      color: #666;
      text-align: center;
    }

    .badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 9pt;
      font-weight: 600;
    }

    .badge-success {
      background: #D1FAE5;
      color: #065F46;
    }

    .badge-warning {
      background: #FEF3C7;
      color: #92400E;
    }

    .badge-error {
      background: #FEE2E2;
      color: #991B1B;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <div class="header">
    <h1>Monthly Health Report</h1>
    <div class="period">{{period.month}}/{{period.year}} â€¢ Generated {{generated_at}}</div>
  </div>

  <!-- Health Score -->
  <div class="health-score">
    <div class="score">{{summary.overall_health_score}}<span style="font-size: 24pt">/100</span></div>
    <div class="label">Overall System Health Score</div>
  </div>

  <!-- Summary Metrics -->
  <div class="section">
    <h2 class="section-title">ðŸ“Š Key Performance Indicators</h2>
    <div class="metrics-grid">
      <div class="metric-card">
        <div class="metric-value">{{summary.uptime_percent}}%</div>
        <div class="metric-label">Uptime</div>
        {{#if summary.uptime_trend}}
        <div class="metric-change {{summary.uptime_trend}}">{{summary.uptime_change}}</div>
        {{/if}}
      </div>
      <div class="metric-card">
        <div class="metric-value">{{summary.error_rate}}%</div>
        <div class="metric-label">Error Rate</div>
      </div>
      <div class="metric-card">
        <div class="metric-value">{{summary.avg_latency_ms}}ms</div>
        <div class="metric-label">Avg Latency</div>
      </div>
    </div>

    <table>
      <thead>
        <tr>
          <th>Metric</th>
          <th>Value</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Total Requests</td>
          <td>{{kpis.requests}}</td>
          <td><span class="badge badge-success">Normal</span></td>
        </tr>
        <tr>
          <td>Total Errors</td>
          <td>{{kpis.errors}}</td>
          <td><span class="badge badge-warning">Monitor</span></td>
        </tr>
        <tr>
          <td>P95 Latency</td>
          <td>{{kpis.p95_latency_ms}}ms</td>
          <td><span class="badge badge-success">Good</span></td>
        </tr>
        <tr>
          <td>P99 Latency</td>
          <td>{{kpis.p99_latency_ms}}ms</td>
          <td><span class="badge badge-success">Good</span></td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Feedback Section -->
  <div class="section">
    <h2 class="section-title">ðŸ’¬ Customer Feedback</h2>
    <div class="metrics-grid">
      <div class="metric-card">
        <div class="metric-value">{{feedback.total_feedback}}</div>
        <div class="metric-label">Total Feedback</div>
      </div>
      <div class="metric-card">
        <div class="metric-value">{{feedback.positive_percent}}%</div>
        <div class="metric-label">Positive</div>
      </div>
      <div class="metric-card">
        <div class="metric-value">{{feedback.negative_percent}}%</div>
        <div class="metric-label">Negative</div>
      </div>
    </div>
  </div>

  <!-- Cost Section -->
  <div class="section">
    <h2 class="section-title">ðŸ’° Cost Analysis</h2>
    <table>
      <thead>
        <tr>
          <th>Category</th>
          <th>Cost (USD)</th>
          <th>% of Total</th>
        </tr>
      </thead>
      <tbody>
        {{#each costs.cost_breakdown}}
        <tr>
          <td>{{@key}}</td>
          <td>${{this}}</td>
          <td>{{percentage}}%</td>
        </tr>
        {{/each}}
        <tr style="font-weight: bold; background: #F9FAFB;">
          <td>Total</td>
          <td>${{costs.total_cost_usd}}</td>
          <td>100%</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Incidents Section -->
  <div class="section">
    <h2 class="section-title">ðŸš¨ Incidents</h2>
    <div class="metrics-grid">
      <div class="metric-card">
        <div class="metric-value">{{incidents.total_incidents}}</div>
        <div class="metric-label">Total Incidents</div>
      </div>
      <div class="metric-card">
        <div class="metric-value">{{incidents.mean_time_to_resolve_minutes}}min</div>
        <div class="metric-label">MTTR</div>
      </div>
      <div class="metric-card">
        <div class="metric-value">{{incidents.by_severity.critical}}</div>
        <div class="metric-label">Critical</div>
      </div>
    </div>
  </div>

  <!-- Recommendations -->
  <div class="section">
    <div class="recommendations">
      <h3>ðŸ’¡ Recommendations</h3>
      <ul>
        {{#each recommendations}}
        <li>{{this}}</li>
        {{/each}}
      </ul>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <p>Orca AgentMesh Cloud Platform â€¢ Confidential Report</p>
    <p>For questions, contact: ops@company.com</p>
  </div>
</body>
</html>
